INSERT INTO 171003_BulkUpload ( PatientID, Chromosome, Start19, Stop19, GenomeAssembly, Change, Chromosomal_sex, openaccess, DoB, [Note], motheris, fatheris, inheritance, pathogenic, PrimaryPheno, [responsible contact], IsMale, IsFemale, IsUnknown, PhenoFormID )
SELECT Patients.PatientID, Chromosome.Chromosome, ArrayOligoPreliminaryResults.Start19, ArrayOligoPreliminaryResults.Stop19, "GRCh37/hg19" AS GenomeAssembly, Change.Change, '' AS Chromosomal_sex, Null AS openaccess, dbo_Patient.DoB, Null AS [note], "Of unknown phenotype" AS motheris, "Of unknown phenotype" AS fatheris, Inheritance.Inheritance, Status.Status AS pathogenic, PhenoForm.PrimaryPheno, "" AS [responsible contact], dbo_Gender.IsMale, dbo_Gender.IsFemale, dbo_Gender.IsUnknown, PhenoForm.PhenoFormID
FROM ArrayTest INNER JOIN (((((dbo_Patient LEFT JOIN dbo_Gender ON dbo_Patient.GenderID = dbo_Gender.GenderID) INNER JOIN ((Phenotype LEFT JOIN PhenoForm ON Phenotype.PhenoFormID = PhenoForm.PhenoFormID) INNER JOIN (Chromosome INNER JOIN (ArrayOligoPreliminaryResults INNER JOIN Patients ON ArrayOligoPreliminaryResults.InternalPatientID = Patients.InternalPatientID) ON Chromosome.ChrID = ArrayOligoPreliminaryResults.ChrID19) ON Phenotype.InternalPatientID = Patients.InternalPatientID) ON dbo_Patient.PatientTrustID = Patients.PatientID) INNER JOIN Status ON ArrayOligoPreliminaryResults.Pathogenic = Status.StatusID) INNER JOIN Change ON ArrayOligoPreliminaryResults.Copies = Change.ChangeID) LEFT JOIN Inheritance ON ArrayOligoPreliminaryResults.InheritanceID = Inheritance.InheritanceID) ON ArrayTest.InternalPatientID = Patients.InternalPatientID
WHERE (((ArrayTest.Service)=True) AND ((ArrayTest.ReferralID)=2) AND ((dbo_Patient.NHSNo) Is Not Null) AND ((ArrayTest.StatusID)=4));
